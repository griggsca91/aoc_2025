package main

import (
	"fmt"
	"os"
	"strconv"
	"strings"
)

func must[T any](t T, err error) T {
	if err != nil {
		panic(err)
	}
	return t
}

func main() {
	bytes := must(os.ReadFile("./input/day6/input.txt"))
	content := strings.TrimSpace(string(bytes))
	// fmt.Println(part1(content))
	fmt.Println(part2(content))
}

func part1(content string) int {
	results := parseContentPart1(content)
	var r int
	for _, v := range results {
		r += v
	}
	return r
}

func part2(content string) int {
	_, _ = parseContentPart2(content)
	return 0
}

type operator func(int, int) int

func parseOperator(s string) operator {
	switch s {
	case "+":
		return Add
	case "*":
		return Multiply
	default:
		panic(fmt.Sprintf("%s don't exist bud", s))
	}
}

func Multiply(x, y int) int {
	fmt.Println("multiply", x, y)
	return x * y
}

func Add(x, y int) int {
	fmt.Println("add", x, y)

	return x + y
}

func parseContentPart2(content string) ([]int, []operator) {
	lines := strings.Split(content, "\n")
	var chars [][]string
	for _, l := range lines {
		chars = append(chars, strings.Split(l, ""))
	}

	fmt.Println(getColumnValues(chars, 1))
	printMatrix(chars)

	return nil, nil
}

func getColumnValues(c [][]string, col int) string {
	s := make([]string, len(c))
	for i := range c {
		s[i] = c[i][col]
	}
	return strings.Join(s, "")
}

func printMatrix(c [][]string) {
	for i := range c {
		for j := range c[i] {
			p := c[i][j]
			if c[i][j] == " " {
				p = "_"
			}
			fmt.Printf("%s ", p)
		}
		fmt.Println()
	}
}

func parseContentPart1(content string) []int {
	lines := strings.Split(content, "\n")

	var operators []operator

	for _, o := range strings.Fields(lines[len(lines)-1]) {
		operators = append(operators, parseOperator(o))
	}
	fmt.Println(operators)

	results := make([]int, len(operators))

	// last line is the operators
	for _, l := range lines[:len(lines)-1] {
		for col, v := range strings.Fields(l) {
			value := must(strconv.Atoi(v))
			if results[col] == 0 {
				results[col] = value
			} else {
				results[col] = operators[col](value, results[col])
			}
			fmt.Println(results[col])
		}
	}

	fmt.Println(results)
	return results
}
